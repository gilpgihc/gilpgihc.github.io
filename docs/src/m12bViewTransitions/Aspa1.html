<!DOCTYPE html>
<html lang="es">

<head>

 <meta charset="UTF-8">
 <meta name="viewport"
   content="width=device-width">
 <title>
  Single Page Application 1
 </title>

 <style>
  nav {
   display: flex;
   align-items: center;
   flex-wrap: wrap;
   align-content: center;
   list-style-type: none;
   gap: 0.5rem;
  }

  @keyframes aparece {

   /* La animación parte de
    * opacidad 0 y automáticamente
    * llega al default que es 1. */
   from {
    opacity: 0;
   }
  }

  @keyframes desvanece {

   /* La animación parte
    * automáticamente del default
    * de opacidad que es 1 y llega
    * a 0. */
   to {
    opacity: 0;
   }
  }

  /* Al terminar una vista, corre 
   * una animación sobre el 
   * elemento con
   * view-transition-name: root,
   * que por default es el tipo
   * html. */
  ::view-transition-old(root) {
   animation-name: desvanece;
   animation-duration: 1s;
  }

  /* Al iniciar la transición a
   * una vista nueva, corre una
   * animación sobre el elemento
   * con
   * view-transition-name: root,
   * que por default es el tipo
   * html. */
  ::view-transition-new(root) {
   animation-name: aparece;
   /* Espera 1s antes de iniciar la
    * animación, para permitir que
    * la vista anterior se
    * desvanezca. */
   animation-delay: 1s;
   animation-duration: 2s;
  }
 </style>

</head>

<body>

 <nav>
  <a href="inicio">Inicio</a>
  <a href="acercade">Acerca de</a>
  <a href="contacto">Contacto</a>
 </nav>

 <main id="inicio">
  <h1>
   Single Page Application 1
  </h1>
  <p>
   Esta es la página principal.
  </p>
 </main>

 <main id="acercade" hidden>
  <h1>Acerca de</h1>
  <p>
   Esta es la página Acerca de.
  </p>
 </main>

 <main id="contacto" hidden>
  <h1>Contacto</h1>
  <p>
   Esta es la página Contacto.
  </p>
 </main>

 <footer>
  <p>
   © 2025
   Gilberto Pacheco Gallegos.
  </p>
 </footer>

 <script>

  // https://www.w3.org/TR/css-view-transitions-1/
  const titulos = new Map([
   [
    "inicio",
    "Single Page Application 1"
   ],
   [
    "acercade",
    "Acerca de - Single Page Application 1"
   ],
   [
    "contacto",
    "Contacto - Single Page Application 1"
   ],
  ])

  const vistas =
   [inicio, acercade, contacto]

  /* Al cliquear detecta si es
   * sobre un enlace y en este caso
   * evita el salto a otra página
   * y muestra la vista
   * seleccionada.
   */
  document.addEventListener(
   "click",
   event => {
    event.preventDefault()
    const target = event.target
    if (
     target instanceof HTMLAnchorElement
    ) {
     try {
      const href = target.href
      /* Se queda con el nombre de
       * la vista. */
      const estado =
       href.substring(
        href.lastIndexOf("/") + 1
       )
      transicion(estado)
      /* Agrega una nueva posición
       * en la historia del
       * navegador, simulando una
       * nueva página, usando el
       * valor de estado para
       * actualizar correctamente
       * la página. */
      history.pushState(
       estado, "", location.href
      )
     } catch (err) {
      console.error(err)
     }
    }
   }
  )

  /* Maneja los botones de avanzar
   * o retroceder en la historia,
   * recuperando el estado para
   * actualizar la página. */
  window.addEventListener(
   "popstate",
   event => {
    if (
     typeof event.state === "string"
    ) {
     transicion(event.state)
    }
   }
  )

  history.replaceState(
   "inicio", "", location.href
  )

  /**
   * @param {string} estado
   */
  function muestraVista(estado) {
   document.title =
    titulos.get(estado) ?? ""
   for (const vista of vistas) {
    vista.hidden =
     estado !== vista.id
   }
  }

  /**
   * Si el navegador tiene soporte
   * para view tansitions, realiza
   * la transición; de lo
   * contrario, solo hace el cambio
   * de vista.
   * @param {string} estado
   */
  function transicion(estado) {
   if (
    typeof document.startViewTransition === "function"
   ) {
    document.startViewTransition(
     () => muestraVista(estado)
    )
   } else {
    muestraVista(estado)
   }
  }

 </script>

</body>

</html>