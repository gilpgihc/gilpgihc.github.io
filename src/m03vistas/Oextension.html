<!DOCTYPE html>
<html lang="es">

<head>
 <meta charset="UTF-8">
 <meta name="viewport"
   content="width=device-width">
 <title>Otra</title>
 <link rel="preconnect"
   href="https://fonts.googleapis.com">
 <link rel="preconnect"
   href="https://fonts.gstatic.com"
   crossorigin>
 <link rel="stylesheet"
   href="https://fonts.googleapis.com/css2?family=Roboto&display=swap">
 <link rel="stylesheet"
   href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined">
 <style>
  html {
   /* Custom properties */
   --Font: -apple-system,
    BlinkMacSystemFont, Roboto,
    sans-serif;
   --TitleLargeFont: var(--Font);
   --TitleLargeSize: 22px;
   --TitleLargeWeight: 400;
   --LabelLargeFont: var(--Font);
   --LabelLargeSize: 14px;
   --LabelLargeWeight: 500;
   --Background: #FFFBFE;
   --OnBackground: #1C1B1F;
   --Surface: #FFFBFE;
   --OnSurface: #1C1B1F;
   --OnSurfaceHover: #1C1B1F14;
   --OnSurfaceFocus: #1C1B1F19;
   --OnSurfacePressed: #1C1B1F1E;
   --OnSurfaceShadow: #1C1B1F99;
   --SurfaceVariant: #E7E0EC;
   --OnSurfaceVariant: #49454F;
   --Primary: #6750A4;
   --OnPrimary: #FFFFFF;
   --Elevation: #F5EEFA;
   --ShapeCornerMedium: 12px;
   --DisabledContent: #1C1B1F60;
   --DisabledContainer:
    #1C1B1F1E;
   --ElevationLevel2:
    0 3px 6px 0px var(--OnSurfaceShadow);
   /* Configuración */
   font-size: 16px;
   font-family: var(--Font);
   color: var(--OnBackground);
   background-color:
    var(--Background);
  }
 </style>
 <script>
  // @ts-check
  const ELEVATION_CLASS =
   "elevation"
  const OPEN_CLASS = "open"
  const MEDIUM_CLASS = "medium"
  const CLASS_CENTRADO = "centrado"
  const CLASS_JUSTIFICADO =
   "justificado"
  const MENU_ID = "menu"
  const HEADLINE_NAME =
   'name="headline"'
  const HEADLINE_SMALL_NAME =
   'name="headline-small"'
  const NAVIGATION_NAME =
   'name="navigation"'
  const ACTION_NAME =
   'name="action"'
  const ICON_NAME = 'name="icon"'
  const OVERFLOW_NAME =
   'name="overflow"'
  const MENU_NAME = 'name="menu"'
  const ES_APPLE =
   /.*(iPad|iPhone|iPod|Mac).*/.
    test(navigator.userAgent)

  class OverflowMenu
   extends HTMLElement {
   constructor() {
    super()
    /**
     * @private
     * @type {ShadowRoot}
     */
    this._shadow = this.
     attachShadow({ mode: "open" })
    this._shadow.innerHTML =
     /* html */
     `<style>
      :host {
       position: relative;
      }

      div {
       position: absolute;
       min-width: 112px;
       max-width: 280px;
       top: 3rem;
       right: 1rem;
       display: block;
       pointer-events: none;
       transform:
        translateY(-50%) scaleY(0);
       transition: transform 0.5s;
       box-sizing: border-box;
       padding: 4px 0;
       border-radius:
        var(--ShapeCornerMedium);
       background-color:
        var(--Elevation);
       cursor: default;
       box-shadow:
        var(--ElevationLevel2);
      }

      :host(.${OPEN_CLASS}) div {
       pointer-events: all;
       transform:
        translateY(0) scaleY(1);
      }

      #${MENU_ID}::slotted(*) {
       display: block;
       border: none;
       background-color:
        transparent;
       color: var(--OnSurface);
       font-family:
        var(--LabelLargeFont);
       font-size:
        var(--LabelLargeSize);
       font-weight:
        var(--LabelLargeWeight);
       box-sizing: border-box;
       width: 100%;
       height: 48px;
       line-height: 48px;
       padding: 0 12px;
       white-space: nowrap;
       text-overflow: ellipsis;
       overflow: hidden;
       text-align: start;
      }

      #${MENU_ID}::slotted(:hover) {
       background-color:
        var(--OnSurfaceHover);
      }

      #${MENU_ID}::slotted(:focus) {
       background-color:
        var(--OnSurfaceFocus);
      }

      #${MENU_ID}::slotted(:active) {
       background-color:
        var(--Primary);
       background-position: center;
       background-image: radial-gradient(circle, transparent 1%, var(--SurfaceVariant) 1%);
       background-size: 100%;
       animation-fill-mode:
        forwards;
       animation-name: rippleMenu;
       animation-duration: 0.5s;
      }
     </style>
     <slot ${ICON_NAME}></slot>
     <div>
      <slot id="${MENU_ID}"></slot>
     </div>`
    this._alterna =
     this._alterna.bind(this)
    this._clickCierra =
     this._clickCierra.bind(this)
    /**
     * @private
     * @type {HTMLSlotElement|
     *        null}
     */
    this._icon = this._shadow.
     querySelector(
      `[${ICON_NAME}]`)
    /**
     * @private
     * @type {HTMLSlotElement|
     *        null}
     */
    this._menu = this._shadow.
     querySelector(`[${MENU_ID}]`)
    /**
     * @private
     * @type {Element|null}
     */
    this._iconElement = null
    if (this._icon !== null) {
     this._icon.addEventListener(
      "slotchange",
      () => this._iconConfig())
    }
    if (this._menu !== null) {
     this._menu.
      addEventListener(
       "slotchange", () =>
       this._menuConfig())
    }
   }

   /** @private */
   _iconConfig() {
    if (this._iconElement
     !== null) {
     this._iconElement.
      removeEventListener(
       "click", this._alterna)
     this._iconElement = null
    }
    if (this._icon !== null) {
     for (const e of this._icon
      .assignedElements()) {
      this._iconElement = e
      e.addEventListener("click",
       this._alterna)
      e.innerHTML =
       ES_APPLE ? /* html */
        `<span style="color:
           var(--OnSurfaceVariant)"
           class="material-symbols-outlined">
           more_horiz
         </span>`
        : /* html */
        `<span style="color:
           var(--OnSurfaceVariant)"
           class="material-symbols-outlined">
           more_vert
         </span>`
     }
    }
   }

   /** @private */
   _menuConfig() {
    if (this._menu !== null) {
     for (const e of this._menu
      .assignedElements()) {
      const span =
       e.querySelector("span")
      if (span !== null) {
       span.style.verticalAlign =
        "middle";
       span.style.marginRight =
        "12px";
      }
     }
    }
   }

   /** @private */
   _alterna() {
    const list = this.classList
    list.toggle(OPEN_CLASS)
    if (list
     .contains(OPEN_CLASS)) {
     document.addEventListener(
      "click", this._clickCierra)
    } else {
     document.removeEventListener(
      "click", this._clickCierra)
    }
   }

   /**
    * @private
    * @param {Event} evt
    */
   _clickCierra(evt) {
    const target = evt.target
    if (this.classList
     .contains(OPEN_CLASS)
     && this._iconElement
     !== null
     && target
     instanceof HTMLElement
     && !this._iconElement.
      contains(target)) {
     this.classList
      .remove(OPEN_CLASS)
     document.removeEventListener(
      "click", this._clickCierra)
    }
   }
  }

  customElements.define(
   "overflow-menu", OverflowMenu)

  class TopAppBar
   extends HTMLElement {
   constructor() {
    super()
    /**
     * @private
     * @type {ShadowRoot}
     */
    this._shadow = this.
     attachShadow({ mode: "open" })
    this._shadow.innerHTML =
     /* html */
     `<style>
      :host {
       z-index: 2;
       position: sticky;
       top: 0;
       display: block;
       color: var(--OnSurface);
       background-color:
        var(--Surface)
      }

      :host(.${ELEVATION_CLASS}) {
       background-color:
        var(--Elevation);
      }

      #base {
       display: flex;
       align-items: center;
       padding-left: 4px;
       padding-right: 4px;
      }

      #navigation {
       min-height: 24px;
       min-width: 12px;
      }

      [${HEADLINE_NAME}]::slotted(*) {
       height: 64px;
       line-height: 64px;
       white-space: nowrap;
       text-overflow: ellipsis;
       overflow: hidden;
       font-family:
        var(--TitleLargeFont);
       font-size:
        var(--TitleLargeSize);
       font-weight:
        var(--TitleLargeWeight);
      }

      :host(.${MEDIUM_CLASS}) [${HEADLINE_NAME}]::slotted(*) {
       height: 24px;
       pointer-events: none;
       transform:
        translateY(50%) scaleY(0);
       transition: 0.5s;
      }

      :host(.${MEDIUM_CLASS}.${ELEVATION_CLASS}) [${HEADLINE_NAME}]::slotted(*) {
       height: 64px;
       pointer-events: all;
       transform:
        translateY(0) scaleY(1);
      }

      [${HEADLINE_SMALL_NAME}]::slotted(*) {
       box-sizing: border-box;
       margin: 0;
       padding: 0 16px 16px 16px;
       font-family:
        var(--TitleLargeFont);
       font-size:
        var(--TitleLargeSize);
       font-weight:
        var(--TitleLargeWeight);
       transform: scaleY(1);
       transition: 0.5s;
      }

      :host(.${ELEVATION_CLASS}) [${HEADLINE_SMALL_NAME}]::slotted(*) {
       height: 0;
       padding: 0;
       pointer-events: none;
       transform: scaleY(0);
      }

      :host(.${CLASS_CENTRADO}) [${HEADLINE_NAME}]::slotted(*) {
       position: absolute;
       top: 0;
       left: 0;
       right: 0;
       margin: 0 70px;
       line-height: 64px;
       text-align: center;
      }

      :host(.${CLASS_JUSTIFICADO}) [${HEADLINE_NAME}]::slotted(*) {
       flex: 1 0;
       margin: 0;
       padding-left: 4px;
       padding-right: 12px;
       line-height: 64px;
      }

      [${OVERFLOW_NAME}]::slotted(*) {
       margin-left: auto;
      }
     </style>
     <div id="base">
      <div id="navigation">
       <slot
         ${NAVIGATION_NAME}></slot>
      </div>
      <slot
       ${HEADLINE_NAME}></slot>
      <slot ${ACTION_NAME}></slot>
      <slot
       ${OVERFLOW_NAME}></slot>
     </div>
     <slot ${HEADLINE_SMALL_NAME}>
     </slot>
     <slot
       name="adicional"></slot>`
    /**
     * @private
     * @type {number}
     */
    this._posY = 0
    /**
     * @private
     * @type {boolean}
     */
    this._scrolling = false
    /**
     * @private
     * @type {HTMLSlotElement|
     *        null}
     */
    this._action = this._shadow.
     querySelector(
      `[${ACTION_NAME}]`)
    if (this._action !== null) {
     this._action.
      addEventListener(
       "slotchange", () =>
       this._configAction())
    }
    addEventListener("scroll",
     () => this._onScroll())
   }

   connectedCallback() {
    this._configAction()
   }

   /** @private */
   _configAction() {
    if (this._action !== null) {
     const elements = this.
      _action.assignedElements()
     if (this.isConnected) {
      if (ES_APPLE
       && elements.length === 0) {
       this.isConnected
       this.classList.
        add(CLASS_CENTRADO)
       this.classList.
        remove(CLASS_JUSTIFICADO)
      } else {
       this.classList.
        add(CLASS_JUSTIFICADO)
       this.classList.
        remove(CLASS_CENTRADO)
      }
     }
     for (const e of elements) {
      const span =
       e.querySelector("span")
      if (span !== null) {
       span.style.color =
        "var(--OnSurfaceVariant)"
      }
     }
    }
   }

   /** @private */
   _onScroll() {
    this._posY = scrollY
    if (!this._scrolling) {
     requestAnimationFrame(
      () => this._avanza())
    }
    this._scrolling = true
   }

   /** @private */
   _avanza() {
    if (this._posY === 0) {
     this.classList.
      remove(ELEVATION_CLASS)
    } else {
     this.classList.
      add(ELEVATION_CLASS)
    }
    this._scrolling = false
   }
  }

  customElements.
   define("top-app-bar", TopAppBar)

 </script>
 <style>
  body {
   margin: 0;
   scroll-padding-top: 4rem;
  }

  p {
   margin: 1rem;
  }

  @keyframes rippleMenu {
   from {
    color: var(--OnSurfaceVariant);
    background-size: 100%;
   }

   to {
    color: var(--OnPrimary);
    background-size: 15000%;
   }
  }

  button.icon {
   padding: 4px;
   border: none;
   background-color: transparent;
  }

  button.icon:focus {
   outline: none;
  }

  button.icon span {
   border-radius: 50%;
   padding: 8px;
   color: var(--OnSurface);
  }

  button.icon:hover span {
   background-color:
    var(--OnSurfaceHover);
  }

  button.icon:focus span {
   background-color:
    var(--OnSurfaceFocus);
  }

  button.icon:active span {
   background-color:
    var(--OnSurfacePressed);
  }

  button.icon:disabled span {
   color: var(--DisabledContent);
   background-color:
    var(--DisabledContainer);
  }
 </style>
</head>

<body>
 <top-app-bar class="medium">
  <h1 slot="headline">Otra</h1>
  <h1 slot="headline-small">
   Otra página con título largo
  </h1>
  <button type="button"
    class="icon" slot="navigation">
   <span
     class="material-symbols-outlined">
    menu
   </span>
  </button>
  <button type="button"
    class="icon" slot="action"
    title="Agregar">
   <span
     class="material-symbols-outlined">
    add
   </span>
  </button>
  <button type="button"
    class="icon" slot="action"
    title="Editar">
   <span
     class="material-symbols-outlined">
    edit
   </span>
  </button>
  <overflow-menu slot="overflow">
   <button type="button"
     class="icon" slot="icon">
   </button>
   <button type="button">
    <span
      class="material-symbols-outlined">
     star
    </span>
    Marcar favorito
   </button>
   <button type="button">
    <span
      class="material-symbols-outlined">
     delete
    </span>
    Eliminar
   </button>
  </overflow-menu>
 </top-app-bar>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
 <p>x</p>
</body>

</html>